<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>School Plan (by yevh)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0d0d0d;
      --panel:#1a1a1a;
      --muted:#9aa0a6;
      --text:#f0f0f0;
      --accent:#00ffcc;
      --past-bg:#004d26;
      --past-text:#aaffaa;
      --current-bg:#ff6600;
      --weekend:#ffcc00;
      --dim:#333;
    }

    html,body{height:100%;margin:0;font-family:"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);}

    /* Top-left date */
    .daydate {
      position: fixed;
      top: 14px;
      left: 20px;
      color: var(--accent);
      font-weight: 700;
      text-shadow: 0 0 10px rgba(0,255,204,0.15);
      z-index: 30;
    }

    /* Top center days */
    .topbar {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 30;
    }
    .dayBtn {
      background: var(--panel);
      color: var(--muted);
      padding: 8px 14px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.03);
      cursor: pointer;
      user-select: none;
      transition: all .18s ease;
      font-weight: 600;
    }
    .dayBtn:hover { background: #2a2a2a; color: #fff; transform: translateY(-2px); }
    .dayBtn.active {
      background: var(--accent);
      color: #000;
      box-shadow: 0 0 14px rgba(0,255,204,0.12);
      transform: none;
    }

    /* Valgfag selector under days */
    .valgfagBar {
      position: fixed;
      top: 52px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12px;
      align-items: center;
      z-index: 30;
      color: var(--text);
      font-size: 14px;
    }
    .vfLabel { color: var(--muted); font-weight: 600; margin-right: 6px; }
    .vfBtn {
      background: var(--panel);
      color: var(--muted);
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.03);
      cursor: pointer;
      transition: all .15s ease;
      font-weight: 600;
    }
    .vfBtn:hover { background:#2a2a2a; color:#fff; }
    .vfBtn.selected { background:#333; color:#fff; box-shadow:none; }
    .confirmBtn {
      background: var(--accent);
      color: #000;
      padding: 6px 12px;
      border-radius: 8px;
      border: none;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 0 12px rgba(0,255,204,0.12);
    }
    .confirmBtn:disabled {
      background:#2b6f62;
      color:#072b26;
      cursor:not-allowed;
      box-shadow:none;
    }

    /* Layout */
    .main {
      display: flex;
      width: 100%;
      align-items: flex-start;
      gap: 20px;
      padding-top: 90px;
      box-sizing: border-box;
    }

    /* Left column: big clock */
    .leftCol {
      width: 260px;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding-left: 20px;
    }
    .clockCircle {
      width: 220px;
      height: 220px;
      border-radius: 50%;
      border: 6px solid var(--accent);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--accent);
      box-shadow: 0 0 30px rgba(0,255,204,0.06);
      margin-top: 20px;
    }
    .clockSmall {
      margin-top: 12px;
      color: var(--muted);
      font-size: 13px;
    }

    /* Center: plan */
    .centerCol {
      flex: 1;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding-bottom: 40px;
    }
    h1.title {
      margin: 0 0 14px 0;
      color: var(--accent);
      font-size: 1.6rem;
      text-shadow: 0 0 12px rgba(0,255,204,0.06);
      font-weight: 800;
    }
    .plan {
      width: min(920px, 78%);
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .item {
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding: 12px 16px;
      border-radius: 10px;
      background: var(--panel);
      border: 1px solid rgba(255,255,255,0.03);
      transition: all .12s ease;
      font-weight: 700;
    }
    .item .left { color: var(--muted); font-weight:700; }
    .item .right { color: var(--text); font-weight:700; }
    .item.past { background: var(--past-bg); color: var(--past-text); }
    .item.current { background: var(--current-bg); color: #fff; box-shadow: 0 0 14px rgba(255,102,0,0.12); }
    .item.future { background: var(--dim); color: #bdbdbd; }
    .item.dimmed { filter: grayscale(.8) brightness(.7); color: #9aa0a6; }

    .message {
      padding: 16px;
      border-radius: 10px;
      background: #222;
      color: var(--weekend);
      text-align:center;
      font-weight:700;
      border: 1px solid rgba(255,255,255,0.03);
    }

    /* Right column: sidebar */
    .rightCol {
      width: 280px;
      padding-right: 20px;
      box-sizing: border-box;
    }
    .sidebar {
      position: sticky;
      top: 110px;
      background: #0b0b0b;
      border-radius: 8px;
      padding: 18px;
      border: 1px solid rgba(255,255,255,0.03);
    }
    .sidebar h2 { margin: 0 0 12px 0; color: var(--accent); font-size: 1.05rem; font-weight:800; }
    .stat { color: #ddd; margin: 8px 0; font-weight:700; }

    /* Responsive */
    @media (max-width: 980px){
      .leftCol { display:none; }
      .rightCol { display:none; }
      .plan { width: 92%; }
      .topbar { top: 6px; }
      .valgfagBar { top: 46px; }
    }
  </style>
</head>
<body>
  <div class="daydate" id="dayDate">Loading date...</div>

  <!-- Days selector -->
  <div class="topbar" id="daysSelector"></div>

  <!-- Valgfag selector -->
  <div class="valgfagBar">
    <div class="vfLabel">Your Valgfag:</div>
    <div class="vfBtn" id="vfMad1">Mad 1 og Billed</div>
    <div class="vfBtn" id="vfMad2">Mad 2 og H/D</div>
    <button class="confirmBtn" id="confirmValgfag" disabled>Confirm</button>
  </div>

  <div class="main">
    <div class="leftCol">
      <div class="clockCircle" id="bigClock">00:00:00</div>
      <div class="clockSmall" id="clockNote">Local time</div>
    </div>

    <div class="centerCol">
      <h1 class="title" id="planTitle">School Plan (by yevh)</h1>
      <div class="plan" id="planList"></div>
    </div>

    <div class="rightCol">
      <div class="sidebar">
        <h2>Progress</h2>
        <div class="stat" id="elapsed">Elapsed: 0h 0m</div>
        <div class="stat" id="remaining">Remaining: 0h 0m</div>
      </div>
    </div>
  </div>

  <script>
    // Timezone for display
    const TZ = 'Europe/Berlin';

    // Days of week
    const DAYS = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];

    // Selected day (default to today)
    let selectedDay = new Date().toLocaleDateString('en-GB',{weekday:'long', timeZone: TZ});

    // Valgfag state
    let pendingValgfag = null; // chosen but not confirmed
    let valgfag = localStorage.getItem('valgfagName') || null; // confirmed

    // DOM refs
    const dayDateEl = document.getElementById('dayDate');
    const daysSelector = document.getElementById('daysSelector');
    const planList = document.getElementById('planList');
    const planTitle = document.getElementById('planTitle');
    const bigClock = document.getElementById('bigClock');
    const elapsedEl = document.getElementById('elapsed');
    const remainingEl = document.getElementById('remaining');

    const vfMad1 = document.getElementById('vfMad1');
    const vfMad2 = document.getElementById('vfMad2');
    const confirmBtn = document.getElementById('confirmValgfag');

    // Helper: format date label (no time)
    function updateDayDate(){
      const now = new Date();
      const label = now.toLocaleDateString('en-GB', { weekday:'long', year:'numeric', month:'long', day:'numeric', timeZone: TZ });
      dayDateEl.textContent = label;
    }

    // Big clock with seconds
    function updateBigClock(){
      const now = new Date();
      const time = now.toLocaleTimeString('en-GB', { hour12:false, hour:'2-digit', minute:'2-digit', second:'2-digit', timeZone: TZ });
      bigClock.textContent = time;
    }

    // Render top days selector
    function renderDays(){
      daysSelector.innerHTML = '';
      DAYS.forEach(day => {
        const btn = document.createElement('div');
        btn.className = 'dayBtn';
        btn.textContent = day;
        if(day === selectedDay) btn.classList.add('active');
        btn.onclick = () => {
          selectedDay = day;
          document.querySelectorAll('.dayBtn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          renderAll();
        };
        daysSelector.appendChild(btn);
      });
    }

    // Valgfag UI handlers
    function chooseValgfag(name){
      pendingValgfag = name;
      vfMad1.classList.toggle('selected', name === 'Mad 1 og Billed');
      vfMad2.classList.toggle('selected', name === 'Mad 2 og H/D');
      confirmBtn.disabled = false;
    }
    vfMad1.onclick = () => chooseValgfag('Mad 1 og Billed');
    vfMad2.onclick = () => chooseValgfag('Mad 2 og H/D');

    confirmBtn.onclick = () => {
      if(!pendingValgfag) return;
      valgfag = pendingValgfag;
      localStorage.setItem('valgfagName', valgfag);
      confirmBtn.disabled = true;
      // reflect selection visually
      vfMad1.classList.toggle('selected', valgfag === 'Mad 1 og Billed');
      vfMad2.classList.toggle('selected', valgfag === 'Mad 2 og H/D');
      renderAll();
    };

    // If previously confirmed, show selection
    if(valgfag){
      pendingValgfag = valgfag;
      vfMad1.classList.toggle('selected', valgfag === 'Mad 1 og Billed');
      vfMad2.classList.toggle('selected', valgfag === 'Mad 2 og H/D');
      confirmBtn.disabled = true;
    }

    // Time parsing helper (returns Date object for today with given HH:MM)
    function parseTimeHM(hm){
      const [h,m] = hm.split(':').map(Number);
      const d = new Date();
      d.setHours(h, m, 0, 0);
      return d;
    }

    // Check if selected day is today's weekday (in TZ)
    function isTodaySelected(){
      const todayName = new Date().toLocaleDateString('en-GB', { weekday:'long', timeZone: TZ });
      return selectedDay === todayName;
    }

    function isWeekend(day){
      return day === 'Saturday' || day === 'Sunday';
    }

    // --- Schedules ---
    // Wednesday
    const wednesdaySchedule = [
      { start: "08:00", end: "08:45", subject: "Matematik DB/TH" },
      { start: "08:45", end: "09:30", subject: "Matematik DB/TH" },
      { start: "09:30", end: "10:00", subject: "Break" },
      { start: "10:00", end: "10:45", subject: "Biologi MAK" },
      { start: "10:45", end: "11:30", subject: "Biologi MAK" },
      { start: "11:30", end: "12:00", subject: "Break" },
      { start: "12:00", end: "12:45", subject: "Dansk PW" },
      { start: "12:45", end: "13:30", subject: "Dansk PW" },
      { start: "13:30", end: "13:45", subject: "Break" },
      { start: "13:45", end: "14:30", subject: "Tysk CB" },
      { start: "14:30", end: "15:15", subject: "Tysk CB" }
    ];

    // Thursday base 6 lessons (ends 13:30)
    const thursdayBase6 = [
      { start: "08:00", end: "08:45", subject: "Dansk PW" },
      { start: "08:45", end: "09:30", subject: "Geografi MAK" },
      { start: "09:30", end: "10:00", subject: "Break" },
      { start: "10:00", end: "10:45", subject: "Tysk CB" },
      { start: "10:45", end: "11:30", subject: "Englesk DB" },
      { start: "11:30", end: "12:00", subject: "Break" },
      { start: "12:00", end: "12:45", subject: "Tysk CB" },
      { start: "12:45", end: "13:30", subject: "Englesk DB" }
    ];
    const thursdayValgfagExtra = [
      { start: "13:30", end: "13:45", subject: "Break" },
      { start: "13:45", end: "14:30", subject: "MAD 2 og H/D" },
      { start: "14:30", end: "15:15", subject: "MAD 2 og H/D" }
    ];

    // Friday schedule (user-provided)
    const fridaySchedule = [
      { start: "08:00", end: "08:45", subject: "Historie PW" },
      { start: "08:45", end: "09:30", subject: "Historie PW" },
      { start: "09:30", end: "10:00", subject: "Break" },
      { start: "10:00", end: "10:45", subject: "Matematik DB/TH" },
      { start: "10:45", end: "11:30", subject: "Dansk PW" },
      { start: "11:30", end: "12:00", subject: "Break" },
      { start: "12:00", end: "12:45", subject: "Fysik/kemi/JES/MAK" },
      { start: "12:45", end: "13:30", subject: "Fysik/kemi/JES/MAK" }
    ];

    // Monday base (user-provided)
    const mondayBase = [
      { start: "08:00", end: "08:45", subject: "Dansk PW" },
      { start: "08:45", end: "09:30", subject: "Dansk PW" },
      { start: "09:30", end: "10:00", subject: "Break" },
      { start: "10:00", end: "10:45", subject: "IdrÃ¦t DB/PW" },
      { start: "10:45", end: "11:30", subject: "IdrÃ¦t DB/PW" },
      { start: "11:30", end: "12:00", subject: "Break" },
      { start: "12:00", end: "12:45", subject: "Matematik DB/TH" },
      { start: "12:45", end: "13:30", subject: "Matematik DB/TH" }
    ];
    const mondayValgfagExtra = [
      { start: "13:30", end: "13:45", subject: "Break" },
      { start: "13:45", end: "14:30", subject: "MAD 1 og Billed" },
      { start: "14:30", end: "15:15", subject: "MAD 1 og Billed" }
    ];

    // Tuesday schedule (user-provided) â€” starts at 10:00
    const tuesdaySchedule = [
      { start: "10:00", end: "10:45", subject: "Englesk DB" },
      { start: "10:45", end: "11:30", subject: "Englesk DB" },
      { start: "11:30", end: "12:00", subject: "Break" },
      { start: "12:00", end: "12:45", subject: "Valgfag - Ekstra DB/PW" },
      { start: "12:45", end: "13:30", subject: "Valgfag - Ekstra DB/PW" }
    ];

    // Get schedule for a day, applying valgfag rules
    function getScheduleFor(day){
      if(day === 'Monday'){
        // If confirmed valgfag is Mad 1 og Billed, include extra lessons on Monday
        return (valgfag === 'Mad 1 og Billed') ? mondayBase.concat(mondayValgfagExtra) : mondayBase.slice();
      }
      if(day === 'Tuesday') return tuesdaySchedule.slice();
      if(day === 'Wednesday') return wednesdaySchedule.slice();
      if(day === 'Thursday'){
        // If confirmed valgfag is Mad 2 og H/D, include extra lessons on Thursday
        return (valgfag === 'Mad 2 og H/D') ? thursdayBase6.concat(thursdayValgfagExtra) : thursdayBase6.slice();
      }
      if(day === 'Friday') return fridaySchedule.slice();
      // Other days: no plan yet
      return [];
    }

    // Render plan list
    function renderPlan(){
      planList.innerHTML = '';
      planTitle.textContent = `School Plan (by yevh) - ${selectedDay}`;

      // Weekend message
      if(isWeekend(selectedDay)){
        const msg = document.createElement('div');
        msg.className = 'message';
        msg.textContent = 'Weekend â€” no school plan ðŸŽ‰';
        planList.appendChild(msg);
        return;
      }

      const schedule = getScheduleFor(selectedDay);
      const now = new Date();
      const todaySelected = isTodaySelected();
      const valgfagConfirmed = !!valgfag;

      if(schedule.length === 0){
        const msg = document.createElement('div');
        msg.className = 'message';
        msg.textContent = 'Not today â€” plan not available yet';
        planList.appendChild(msg);
        return;
      }

      schedule.forEach(item => {
        const start = parseTimeHM(item.start);
        const end = parseTimeHM(item.end);
        const row = document.createElement('div');
        row.className = 'item';
        row.innerHTML = `<div class="left">${item.start} â€” ${item.end}</div><div class="right">${item.subject}</div>`;

        // If valgfag not confirmed, keep dimmed
        if(!valgfagConfirmed){
          row.classList.add('dimmed');
        } else if(!todaySelected){
          // If viewing another day, dim for reference
          row.classList.add('dimmed');
        } else {
          if(now > end) row.classList.add('past');
          else if(now >= start && now <= end) row.classList.add('current');
          else row.classList.add('future');
        }

        planList.appendChild(row);
      });

      // Add contextual message
      if(!valgfagConfirmed){
        const msg = document.createElement('div');
        msg.className = 'message';
        msg.style.marginTop = '8px';
        msg.textContent = 'Confirm your Valgfag to show todayâ€™s lessons';
        planList.appendChild(msg);
      } else if(!todaySelected){
        const msg = document.createElement('div');
        msg.className = 'message';
        msg.style.marginTop = '8px';
        msg.textContent = 'Not today â€” plan shown for reference';
        planList.appendChild(msg);
      }
    }

    // Update progress (elapsed / remaining) in hours and minutes
    function updateProgress(){
      // Weekend
      if(isWeekend(selectedDay)){
        elapsedEl.textContent = 'Elapsed: 0h 0m';
        remainingEl.textContent = 'Remaining: Free day!';
        return;
      }

      // If no schedule or valgfag not confirmed, show hints
      const schedule = getScheduleFor(selectedDay);
      if(schedule.length === 0){
        elapsedEl.textContent = 'Elapsed: 0h 0m';
        remainingEl.textContent = 'Remaining: Not scheduled';
        return;
      }
      if(!valgfag){
        elapsedEl.textContent = 'Elapsed: 0h 0m';
        remainingEl.textContent = 'Remaining: Confirm Valgfag';
        return;
      }

      const start = parseTimeHM(schedule[0].start);
      const end = parseTimeHM(schedule[schedule.length - 1].end);
      const now = new Date();

      let elapsedMin = 0;
      let remainingMin = 0;

      if(now <= start){
        elapsedMin = 0;
        remainingMin = Math.round((end - start) / 60000);
      } else if(now >= end){
        elapsedMin = Math.round((end - start) / 60000);
        remainingMin = 0;
      } else {
        elapsedMin = Math.round((now - start) / 60000);
        remainingMin = Math.round((end - now) / 60000);
      }

      const eh = Math.floor(elapsedMin / 60);
      const em = elapsedMin % 60;
      const rh = Math.floor(remainingMin / 60);
      const rm = remainingMin % 60;

      elapsedEl.textContent = `Elapsed: ${eh}h ${em}m`;
      remainingEl.textContent = `Remaining: ${rh}h ${rm}m`;
    }

    // Full render
    function renderAll(){
      updateDayDate();
      renderPlan();
      updateProgress();
    }

    // Initial render setup
    renderDays();
    renderAll();
    updateBigClock();

    // Ticking updates
    setInterval(() => {
      updateBigClock();
      renderAll();
    }, 1000);

    // End of script
  </script>
</body>
</html>
